<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

    <head>
        <meta charset="UTF-8">
        <title>Métodos Numéricos</title>

        <!-- Bootstrap CSS -->
        <link 
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
            rel="stylesheet" 
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" 
            crossorigin="anonymous"
            >   

        <!-- Bootstrap JS and dependencies -->
        <script 
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" 
            crossorigin="anonymous"
        ></script>

        <style>
            .solution-highlight {
                background-color: #e8f5e8;
                border-left: 4px solid #28a745;
                padding: 15px;
                margin: 10px 0;
            }
            .table-differences {
                font-size: 0.9em;
            }
            .polynomial-display {
                font-family: 'Courier New', monospace;
                background-color: #f8f9fa;
                padding: 15px;
                border-radius: 5px;
                margin: 10px 0;
                border-left: 4px solid #007bff;
            }
            .coefficient-highlight {
                background-color: #fff3cd;
                padding: 2px 4px;
                border-radius: 3px;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <nav th:replace="/layout/template :: menu"> </nav>
            <div th:replace="/layout/template :: bannerunit4"></div>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">Inicio</a></li>
                    <li class="breadcrumb-item"><a href="/unit4">Interpolación</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Solución Diferencias Divididas de Newton</li>
                </ol>
            </nav>

            <div class="container">
                <h1 class="text-primary">Interpolación: Diferencias Divididas de Newton - Resultados</h1>

                <!-- Información del problema -->
                <div class="row justify-content-start">
                    <div class="col-12">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5>Información del Problema</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-3">
                                        <strong>Orden del Polinomio:</strong> <span th:text="${solveDDNewton.orden}"></span>
                                    </div>
                                    <div class="col-3">
                                        <strong>Puntos Utilizados:</strong> <span th:text="${solveDDNewton.orden + 1}"></span>
                                    </div>
                                    <div class="col-3">
                                        <strong>Valor a Interpolar:</strong> <span th:text="${solveDDNewton.valorInterpolacion}"></span>
                                    </div>
                                    <div class="col-3">
                                        <strong>Estado:</strong> 
                                        <span th:text="${solveDDNewton.mensajeEstado}" 
                                              class="text-success"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Puntos utilizados -->
                <div class="row">
                    <div class="col-12">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5>Puntos Conocidos</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>Punto</th>
                                                <th>X</th>
                                                <th>Y = f(X)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="i : ${#numbers.sequence(0, solveDDNewton.orden)}">
                                                <td class="text-center fw-bold" th:text="${i}"></td>
                                                <td th:text="${#numbers.formatDecimal(solveDDNewton.puntosX[i], 1, 4)}"></td>
                                                <td th:text="${#numbers.formatDecimal(solveDDNewton.tablaDiferenciasDivididas[i][0], 1, 6)}" 
                                                    th:class="${i == 0} ? 'coefficient-highlight' : ''"></td>
                                                <td th:if="${solveDDNewton.orden >= 1 and i <= solveDDNewton.orden - 1}" 
                                                    th:text="${#numbers.formatDecimal(solveDDNewton.tablaDiferenciasDivididas[i][1], 1, 6)}"
                                                    th:class="${i == 0} ? 'coefficient-highlight' : ''"></td>
                                                <td th:if="${solveDDNewton.orden >= 2 and i <= solveDDNewton.orden - 2}" 
                                                    th:text="${#numbers.formatDecimal(solveDDNewton.tablaDiferenciasDivididas[i][2], 1, 6)}"
                                                    th:class="${i == 0} ? 'coefficient-highlight' : ''"></td>
                                                <td th:if="${solveDDNewton.orden >= 3 and i <= solveDDNewton.orden - 3}" 
                                                    th:text="${#numbers.formatDecimal(solveDDNewton.tablaDiferenciasDivididas[i][3], 1, 6)}"
                                                    th:class="${i == 0} ? 'coefficient-highlight' : ''"></td>
                                                <td th:if="${solveDDNewton.orden >= 4 and i <= solveDDNewton.orden - 4}" 
                                                    th:text="${#numbers.formatDecimal(solveDDNewton.tablaDiferenciasDivididas[i][4], 1, 6)}"
                                                    th:class="${i == 0} ? 'coefficient-highlight' : ''"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="alert alert-info mt-3">
                                    <small><strong>Nota:</strong> Los coeficientes del polinomio corresponden a la primera fila (resaltada) de cada columna de diferencias divididas.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Coeficientes del polinomio -->
                <div class="row" th:if="${solveDDNewton.coeficientes != null}">
                    <div class="col-12">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5>Coeficientes del Polinomio de Newton</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-12">
                                        <p>Los coeficientes extraídos de las diferencias divididas son:</p>
                                        <div class="d-flex flex-wrap gap-3">
                                            <div th:each="coef, stat : ${solveDDNewton.coeficientes}" class="coefficient-highlight p-2 rounded">
                                                <strong>a<sub th:text="${stat.index}"></sub> = </strong>
                                                <span th:text="${#numbers.formatDecimal(coef, 1, 8)}"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Polinomio de Newton -->
                <div class="row" th:if="${solveDDNewton.polinomioNewton != null}">
                    <div class="col-12">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5>Polinomio de Newton</h5>
                            </div>
                            <div class="card-body">
                                <div class="polynomial-display">
                                    <strong>P<sub th:text="${solveDDNewton.orden}"></sub>(x) = </strong>
                                    <span th:text="${solveDDNewton.polinomioNewton}"></span>
                                </div>
                                <div class="alert alert-info mt-3">
                                    <strong>Forma general del polinomio de Newton:</strong><br>
                                    P<sub>n</sub>(x) = f[x<sub>0</sub>] + f[x<sub>0</sub>,x<sub>1</sub>](x-x<sub>0</sub>) + f[x<sub>0</sub>,x<sub>1</sub>,x<sub>2</sub>](x-x<sub>0</sub>)(x-x<sub>1</sub>) + ...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resultado de la interpolación -->
                <div class="row">
                    <div class="col-12">
                        <div class="solution-highlight">
                            <h5><i class="fas fa-bullseye"></i> Resultado de la Interpolación</h5>
                            <div class="row">
                                <div class="col-6">
                                    <h4>
                                        <strong>f(</strong><span th:text="${solveDDNewton.valorInterpolacion}"></span><strong>) = </strong>
                                        <span th:text="${#numbers.formatDecimal(solveDDNewton.valorInterpolado, 1, 8)}" class="text-primary"></span>
                                    </h4>
                                </div>
                                <div class="col-6">
                                    <p class="mb-0"><strong>Método:</strong> Diferencias Divididas de Newton</p>
                                    <p class="mb-0"><strong>Orden:</strong> <span th:text="${solveDDNewton.orden}"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Información adicional -->
                <div class="row">
                    <div class="col-12">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5>Interpretación de Resultados</h5>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-success">
                                    <h6><strong>¿Qué significa este resultado?</strong></h6>
                                    <ul class="mb-0">
                                        <li><strong>Interpolación:</strong> Se estimó el valor de la función en un punto intermedio usando los puntos conocidos</li>
                                        <li><strong>Polinomio de grado <span th:text="${solveDDNewton.orden}"></span>:</strong> Se construyó usando <span th:text="${solveDDNewton.orden + 1}"></span> puntos dados</li>
                                        <li><strong>Precisión:</strong> El polinomio pasa exactamente por todos los puntos dados</li>
                                        <li><strong>Aplicación:</strong> Este valor puede usarse para estimar datos faltantes en el rango de los puntos conocidos</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botones de navegación -->
                <div class="row">
                    <div class="col-12">
                        <a href="/unit4/formddnewton" class="btn btn-secondary me-2">
                            <i class="fas fa-arrow-left"></i> Nueva Interpolación
                        </a>
                        <a href="/unit4" class="btn btn-primary">
                            <i class="fas fa-home"></i> Volver al Menú
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
                                                <td class="text-center fw-bold" th:text="'P' + (${i} + 1)"></td>
                                                <td th:text="${#numbers.formatDecimal(solveDDNewton.puntosX[i], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(solveDDNewton.puntosY[i], 1, 6)}"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabla de diferencias divididas -->
                <div class="row" th:if="${solveDDNewton.tablaDiferenciasDivididas != null}">
                    <div class="col-12">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5>Tabla de Diferencias Divididas</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-differences">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>i</th>
                                                <th>X<sub>i</sub></th>
                                                <th>f[x<sub>i</sub>]</th>
                                                <th th:if="${solveDDNewton.orden >= 1}">f[x<sub>i</sub>,x<sub>i+1</sub>]</th>
                                                <th th:if="${solveDDNewton.orden >= 2}">f[x<sub>i</sub>,x<sub>i+1</sub>,x<sub>i+2</sub>]</th>
                                                <th th:if="${solveDDNewton.orden >= 3}">f[x<sub>i</sub>,x<sub>i+1</sub>,x<sub>i+2</sub>,x<sub>i+3</sub>]</th>
                                                <th th:if="${solveDDNewton.orden >= 4}">f[x<sub>i</sub>,x<sub>i+1</sub>,x<sub>i+2</sub>,x<sub>i+3</sub>,x<sub>i+4</sub>]</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="i : ${#numbers.sequence(0, solveDDNewton.orden)}">
                                