<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

    <head>
        <meta charset="UTF-8">
        <title>Métodos Numéricos</title>

        <!-- Bootstrap CSS -->
        <link 
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
            rel="stylesheet" 
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" 
            crossorigin="anonymous"
            >   

        <!-- Bootstrap JS and dependencies -->
        <script 
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" 
            crossorigin="anonymous"
        ></script>

        <style>
            .iteration-table {
                font-size: 0.9em;
            }
            .solution-highlight {
                background-color: #e8f5e8;
                border-left: 4px solid #28a745;
                padding: 15px;
                margin: 10px 0;
            }
            .matrix-display {
                font-family: monospace;
                background-color: #f8f9fa;
                padding: 10px;
                border-radius: 5px;
                margin: 5px;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <nav th:replace="/layout/template :: menu"> </nav>
            <div th:replace="/layout/template :: bannerunit3"></div>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">Inicio</a></li>
                    <li class="breadcrumb-item"><a href="/unit3">Sistemas Lineales</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Solución Método de Jacobi</li>
                </ol>
            </nav>

            <div class="container">
                <h1 class="text">Método Iterativo: Jacobi - Resultados</h1>

                <!-- Información del sistema -->
                <div class="row justify-content-start">
                    <div class="col-12">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5>Información del Sistema</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-3">
                                        <strong>Tamaño del Sistema:</strong> <span th:text="${solveJacobi.MN}"></span>x<span th:text="${solveJacobi.MN}"></span>
                                    </div>
                                    <div class="col-3">
                                        <strong>Tolerancia:</strong> <span th:text="${solveJacobi.tolerancia}"></span>%
                                    </div>
                                    <div class="col-3">
                                        <strong>Iteraciones realizadas:</strong> <span th:text="${solveJacobi.iteracionesRealizadas}"></span>
                                    </div>
                                    <div class="col-3">
                                        <strong>¿Convergió?:</strong> 
                                        <span th:text="${solveJacobi.convergio}" 
                                              th:class="${solveJacobi.convergio} ? 'text-success' : 'text-danger'"></span>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-12">
                                        <strong>Estado:</strong> 
                                        <span th:text="${solveJacobi.mensajeEstado}" 
                                              th:class="${solveJacobi.convergio} ? 'text-success' : 'text-warning'"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mostrar matrices del sistema -->
                <div class="row">
                    <div class="col-12">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5>Sistema de Ecuaciones</h5>
                            </div>
                            <div class="card-body">
                                <!-- Sistema 2x2 -->
                                <div th:if="${solveJacobi.MN == 2}" class="container text-center">
                                    <div class="row align-items-start">
                                        <div class="col">
                                            <p><strong>MATRIZ A</strong></p>
                                            <div class="matrix-display">
                                                <div class="row">
                                                    <div class="col" th:text="${solveJacobi.matrizA[0]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[1]}"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col" th:text="${solveJacobi.matrizA[2]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[3]}"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-2">
                                            <p><strong>Vector B</strong></p>
                                            <div class="matrix-display">
                                                <div th:text="${solveJacobi.vectorB[0]}"></div>
                                                <div th:text="${solveJacobi.vectorB[1]}"></div>
                                            </div>
                                        </div>
                                        <div class="col-2">
                                            <p><strong>Valores Iniciales</strong></p>
                                            <div class="matrix-display">
                                                <div>x₀ = <span th:text="${solveJacobi.valoresIniciales[0]}"></span></div>
                                                <div>y₀ = <span th:text="${solveJacobi.valoresIniciales[1]}"></span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sistema 3x3 -->
                                <div th:if="${solveJacobi.MN == 3}" class="container text-center">
                                    <div class="row align-items-start">
                                        <div class="col">
                                            <p><strong>MATRIZ A</strong></p>
                                            <div class="matrix-display">
                                                <div class="row">
                                                    <div class="col" th:text="${solveJacobi.matrizA[0]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[1]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[2]}"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col" th:text="${solveJacobi.matrizA[3]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[4]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[5]}"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col" th:text="${solveJacobi.matrizA[6]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[7]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[8]}"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-2">
                                            <p><strong>Vector B</strong></p>
                                            <div class="matrix-display">
                                                <div th:text="${solveJacobi.vectorB[0]}"></div>
                                                <div th:text="${solveJacobi.vectorB[1]}"></div>
                                                <div th:text="${solveJacobi.vectorB[2]}"></div>
                                            </div>
                                        </div>
                                        <div class="col-2">
                                            <p><strong>Valores Iniciales</strong></p>
                                            <div class="matrix-display">
                                                <div>x₀ = <span th:text="${solveJacobi.valoresIniciales[0]}"></span></div>
                                                <div>y₀ = <span th:text="${solveJacobi.valoresIniciales[1]}"></span></div>
                                                <div>z₀ = <span th:text="${solveJacobi.valoresIniciales[2]}"></span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sistema 4x4 -->
                                <div th:if="${solveJacobi.MN == 4}" class="container text-center">
                                    <div class="row align-items-start">
                                        <div class="col">
                                            <p><strong>MATRIZ A</strong></p>
                                            <div class="matrix-display">
                                                <div class="row">
                                                    <div class="col" th:text="${solveJacobi.matrizA[0]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[1]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[2]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[3]}"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col" th:text="${solveJacobi.matrizA[4]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[5]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[6]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[7]}"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col" th:text="${solveJacobi.matrizA[8]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[9]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[10]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[11]}"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col" th:text="${solveJacobi.matrizA[12]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[13]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[14]}"></div>
                                                    <div class="col" th:text="${solveJacobi.matrizA[15]}"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-2">
                                            <p><strong>Vector B</strong></p>
                                            <div class="matrix-display">
                                                <div th:text="${solveJacobi.vectorB[0]}"></div>
                                                <div th:text="${solveJacobi.vectorB[1]}"></div>
                                                <div th:text="${solveJacobi.vectorB[2]}"></div>
                                                <div th:text="${solveJacobi.vectorB[3]}"></div>
                                            </div>
                                        </div>
                                        <div class="col-2">
                                            <p><strong>Valores Iniciales</strong></p>
                                            <div class="matrix-display">
                                                <div>x₀ = <span th:text="${solveJacobi.valoresIniciales[0]}"></span></div>
                                                <div>y₀ = <span th:text="${solveJacobi.valoresIniciales[1]}"></span></div>
                                                <div>z₀ = <span th:text="${solveJacobi.valoresIniciales[2]}"></span></div>
                                                <div>w₀ = <span th:text="${solveJacobi.valoresIniciales[3]}"></span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Solución final -->
                <div class="row">
                    <div class="col-12">
                        <div class="solution-highlight">
                            <h5><i class="fas fa-trophy"></i> Solución Final</h5>
                            <div class="row" th:if="${solveJacobi.solucionFinal != null}">
                                <div class="col-3" th:if="${solveJacobi.MN >= 1}">
                                    <strong>X₁ = </strong><span th:text="${#numbers.formatDecimal(solveJacobi.solucionFinal[0], 1, 6)}"></span>
                                </div>
                                <div class="col-3" th:if="${solveJacobi.MN >= 2}">
                                    <strong>X₂ = </strong><span th:text="${#numbers.formatDecimal(solveJacobi.solucionFinal[1], 1, 6)}"></span>
                                </div>
                                <div class="col-3" th:if="${solveJacobi.MN >= 3}">
                                    <strong>X₃ = </strong><span th:text="${#numbers.formatDecimal(solveJacobi.solucionFinal[2], 1, 6)}"></span>
                                </div>
                                <div class="col-3" th:if="${solveJacobi.MN >= 4}">
                                    <strong>X₄ = </strong><span th:text="${#numbers.formatDecimal(solveJacobi.solucionFinal[3], 1, 6)}"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabla de iteraciones -->
                <div class="row" th:if="${solveJacobi.iteraciones != null and !solveJacobi.iteraciones.isEmpty()}">
                    <div class="col-12">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5>Tabla de Iteraciones</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <!-- Tabla para sistema 2x2 -->
                                    <table class="table table-striped iteration-table" th:if="${solveJacobi.MN == 2}">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>Iteración</th>
                                                <th>X₁</th>
                                                <th>X₂</th>
                                                <th>Error X₁ (%)</th>
                                                <th>Error X₂ (%)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="iter : ${solveJacobi.iteraciones}">
                                                <td th:text="${#numbers.formatInteger(iter[0], 0)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[1], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[2], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[3], 1, 4)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[4], 1, 4)}"></td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <!-- Tabla para sistema 3x3 -->
                                    <table class="table table-striped iteration-table" th:if="${solveJacobi.MN == 3}">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>Iteración</th>
                                                <th>X₁</th>
                                                <th>X₂</th>
                                                <th>X₃</th>
                                                <th>Error X₁ (%)</th>
                                                <th>Error X₂ (%)</th>
                                                <th>Error X₃ (%)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="iter : ${solveJacobi.iteraciones}">
                                                <td th:text="${#numbers.formatInteger(iter[0], 0)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[1], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[2], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[3], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[4], 1, 4)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[5], 1, 4)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[6], 1, 4)}"></td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <!-- Tabla para sistema 4x4 -->
                                    <table class="table table-striped iteration-table" th:if="${solveJacobi.MN == 4}">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>Iter.</th>
                                                <th>X₁</th>
                                                <th>X₂</th>
                                                <th>X₃</th>
                                                <th>X₄</th>
                                                <th>Err X₁ (%)</th>
                                                <th>Err X₂ (%)</th>
                                                <th>Err X₃ (%)</th>
                                                <th>Err X₄ (%)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="iter : ${solveJacobi.iteraciones}">
                                                <td th:text="${#numbers.formatInteger(iter[0], 0)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[1], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[2], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[3], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[4], 1, 6)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[5], 1, 4)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[6], 1, 4)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[7], 1, 4)}"></td>
                                                <td th:text="${#numbers.formatDecimal(iter[8], 1, 4)}"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botones de navegación -->
                <div class="row">
                    <div class="col-12 text-center">
                        <a href="/unit3/formjacobi" class="btn btn-secondary me-2">
                            <i class="fas fa-arrow-left"></i> Resolver otro sistema
                        </a>
                        <a href="/unit3" class="btn btn-primary">
                            <i class="fas fa-home"></i> Volver al menú principal
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>